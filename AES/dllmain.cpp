// dllmain.cpp : 定义 DLL 应用程序的入口点。
#include "stdafx.h"
#include "AES.h"
#include <stdio.h>

//BOOL APIENTRY DllMain(HMODULE hModule,
//	DWORD  ul_reason_for_call,
//	LPVOID lpReserved
//	)
//{
//	switch (ul_reason_for_call)
//	{
//	case DLL_PROCESS_ATTACH:
//	case DLL_THREAD_ATTACH:
//	case DLL_THREAD_DETACH:
//	case DLL_PROCESS_DETACH:
//		break;
//	}
//	return TRUE;
//}

char* WINAPI AESEncrypt(const char* source, const char* keyHex);
char* WINAPI AESDecrypt(const char* cipherHex, const char* keyHex);

int main()
{
	const char* source = "hellogood";
	const char* keyHex = "30303030303030303030303030303030";

	char* cipherB64 = AESEncrypt(source, keyHex);

	printf("%s\n", cipherB64);

	keyHex = "6B72726F6B776C6C6D75696F6368726B";
	const char* cipherHex = "D5917882ACCB29646F0E96C7C2C578AAB68DC939538E4633608C3A720D8A2E1242A1BCF4FB2B76C560BBDD960B3A3D93A6FC223C5A419ED4C7BA13DDD504C65A38ED51C10A4BD481E1D926BBA7BD6ED3A23F23109C0F49968CE5D6C0EE404987FE2189D3DBB0BD59CE42F92175796FB15B53B0C632FE9763BA4A23A82BBA5E1C678489C0337917C2AA748DC972299CDE4C6BE899406E9ED545BB543686451576EDB104D2C0013C8FF2AF8C4E12F536C223A89BDF442A003C514E2A9F4C240A910494346EC82C7F84517E22F0174C532A111DDA78CE52A54B70ABA8C463AAE3E3CA316B736AC7E4120C28A456CAFBB18992410644A858F9FA3868F7E5196097FAA4BF87D805BA7D2FBDFE27F0A3ABA74E567B7A7F8AD10A4ED000A0EC63004342FD86F6096E0D82A2F9770775DAE3C992382A317F8EA6DC113706DFE44D9929F2DE4C4F26B9B16D14F7C2749FB6983708556F5D5BF07D1ED2E9562BDB9D45CD205B520E2A16C2A619AF16418994227A0343ACDF3010FFAA6F9677B35DF5DAD11B1AE1E3F57204D0F952DE60A8E3C24B6A0A57CA98B65F1D80C2305C08D0ADF116479CE1A01389A69198694E9D5B7EF49527283E1573C18FE2BDAEF82AA1A0ED61892459CE53AA4D353368C6BC37F75F45667FD053B799CD8502E16BD439C6B5F7EE46A928F51160795753F04BDF7273176ABFB6BD4C3BBB02449DAD4702459C230CBDE5B117FE16B0D69A0C4B25907C60A99F09034CA9CEA338EC91333362EB8264EAC8E7E814393528397C79B5D7D09A3A10E2A07B2ACF133AC8B7AC4844F243445808FCC673E865A8A8435EF1CF7F17";
	char* pSource = AESDecrypt(cipherHex, keyHex);

	printf("%s\n", pSource);

	system("pause");
	return 0;
}

